version: 1
frontend:
  phases:
    # ----------------------------------------------------
    # 1. 설치 (preBuild): frontend/app으로 이동 후 의존성 설치
    # ----------------------------------------------------
    preBuild:
      commands:
        # 💡 작업 디렉터리를 package.json이 있는 곳으로 이동
        - cd frontend/app
        # 💡 의존성 설치 (Lockfile이 없어도 실행 가능한 npm install 사용)
        - npm install
    
    # ----------------------------------------------------
    # 2. 빌드 (build): 동일 디렉토리에서 빌드 명령어 실행
    # ----------------------------------------------------
    build:
      commands:
        # 💡 이미 frontend/app 안에 있으므로 cd 명령은 불필요.
        - npm run build
  
  # ----------------------------------------------------
  # 3. 아티팩트 (artifacts): 결과물이 저장된 폴더 지정
  # ----------------------------------------------------
  artifacts:
    # 💡 빌드 결과물(out)은 리포지토리 루트 기준 frontend/app/out에 위치함
    baseDirectory: frontend/app/out 
    files:
      - '**/*'
      
  # ----------------------------------------------------
  # 4. 캐시: node_modules 폴더 캐싱으로 빌드 속도 개선
  # ----------------------------------------------------
  cache:
    paths:
      - frontend/app/node_modules/**/*